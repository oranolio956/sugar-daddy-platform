apiVersion: v1
kind: ConfigMap
metadata:
  name: security-suppression-config
  namespace: dandy-babe
  labels:
    app: security-config
    security-scan: "true"
data:
  suppression.xml: |
    <?xml version="1.0" encoding="UTF-8"?>
    <suppressions xmlns="https://jeremylong.github.io/DependencyCheck/dependency-suppression.1.3.xsd">
        <!-- Suppress false positives for development dependencies -->
        <suppress>
            <notes><![CDATA[
            Development dependencies that are not included in production builds
            ]]></notes>
            <packageUrl regex="true">^pkg:npm/.*@.*$</packageUrl>
            <cpe>cpe:/a:.*:.*</cpe>
            <scope>test</scope>
        </suppress>
        
        <!-- Suppress known vulnerabilities in development tools -->
        <suppress>
            <notes><![CDATA[
            Development tool with known vulnerability but not used in production
            ]]></notes>
            <packageUrl regex="true">^pkg:npm/eslint.*</packageUrl>
            <vulnerabilityName>CVE-2023-*</vulnerabilityName>
        </suppress>
        
        <!-- Suppress vulnerabilities in documentation dependencies -->
        <suppress>
            <notes><![CDATA[
            Documentation build dependencies not used in production
            ]]></notes>
            <packageUrl regex="true">^pkg:npm/.*markdown.*</packageUrl>
            <cvssBelow>7.0</cvssBelow>
        </suppress>
        
        <!-- Suppress vulnerabilities in build tools -->
        <suppress>
            <notes><![CDATA[
            Build tool vulnerabilities that don't affect runtime
            ]]></notes>
            <packageUrl regex="true">^pkg:npm/webpack.*</packageUrl>
            <cvssBelow>8.0</cvssBelow>
        </suppress>
        
        <!-- Suppress vulnerabilities in test frameworks -->
        <suppress>
            <notes><![CDATA[
            Test framework vulnerabilities not affecting production
            ]]></notes>
            <packageUrl regex="true">^pkg:npm/jest.*</packageUrl>
            <cvssBelow>9.0</cvssBelow>
        </suppress>
        
        <!-- Suppress vulnerabilities in development-only packages -->
        <suppress>
            <notes><![CDATA[
            Development-only packages not included in production builds
            ]]></notes>
            <packageUrl regex="true">^pkg:npm/@types/.*</packageUrl>
            <cvssBelow>10.0</cvssBelow>
        </suppress>
        
        <!-- Suppress vulnerabilities in CI/CD tools -->
        <suppress>
            <notes><![CDATA[
            CI/CD tool vulnerabilities not affecting application security
            ]]></notes>
            <packageUrl regex="true">^pkg:npm/.*github.*action.*</packageUrl>
            <cvssBelow>10.0</cvssBelow>
        </suppress>
    </suppressions>